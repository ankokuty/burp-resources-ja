<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../../../../../assets/ps/styles/pssupportnav.css">
</head>
<body>
<section class="container ps-breadcrumbs">
    <ol>
        <li>
            <a href="https://portswigger.net/support">サポートセンタ</a>
        </li>
        <li>
            <a href="../../../index.html">ドキュメント</a>
        </li>
        <li>
            <a href="../../index.html">デスクトップ版</a>
        </li>
        <li>
            <a href="../index.html">オプション</a>
        </li>
        <li>
            <a href="index.html">セッション</a>
        </li>
        <li>
            <a href="macro-editor.html">マクロエディタ</a>
        </li>
    </ol>
</section>
<section class="container labels-editions-wrapper">
    <label class="label-edition is-professional">プロフェッショナル</label>
    <label class="label-edition is-community">コミュニティ</label>
</section>
<section class="maincontainer">
    <div class="container main">
        <h1>オプション: マクロエディタ</h1>
        <p>
            マクロエディタでは、<a href="index.html#macros">マクロ</a>の詳細すべてを設定できます。
        </p>
        <h2 id="record-macro">マクロを記録</h2>
        <p>
            マクロはブラウザを使用して記録されます。ブラウザは、現在のBurpインスタンスをプロキシサーバとして使用するよう<a href="../../getting-started/launching/projects.html">設定されている</a>必要があります。
        </p>
        <p>
            マクロを記録するとき、Burpが<a href="../../tools/proxy/history.html">Proxy履歴</a>を表示するので、そこからマクロで使用するリクエストを選択できます。以前に作成したリクエストから選択するか、再度マクロを記録し、履歴から新たなアイテムを選択できます。ブラウザを使用して新しいマクロを記録するには、<a href="../../tools/proxy/intercept.html">Proxyインターセプト</a>をオフにする必要があります。
        </p>
        <p>
            マクロに含めるアイテムを選択し、"OK"をクリックすると、マクロエディタにアイテムが表示されます。
        </p>
        <h2 id="configuring-macro-items">マクロアイテムを設定</h2>
        <p>
            マクロエディタは、マクロ内のアイテムのリストを表示します。順番の変更、アイテムの削除、マクロの再記録によってこれらを変更できます。リストで選択すると個々のリクエストは変更でき、リクエストビューアで直接編集できます。
        </p>
        <p>
            リクエストの基本シーケンスと同様に、シーケンス内のアイテムの処理方法やアイテム間の依存関係に関する重要な設定が、各マクロにあります。マクロアイテムの設定を編集するには、リスト内でアイテムを選択し、"アイテム設定"をクリックします。
        </p>
        <h3 id="cookie-handling">cookie処理</h3>
        <p>
            以下が設定できます:
        </p>
        <ul>
            <li>
                レスポンスで受け取ったcookieを、セッションハンドリングcookie jarに追加するかどうか
            </li>
            <li>
                セッションハンドリングcookie jarのcookieをリクエストに追加するかどうか
            </li>
        </ul>
        <h3 id="parameter-handling">パラメータ処理</h3>
        <p>
            リクエスト内の各パラメータについて、固定の設定値を使用するか、マクロ内の先行するレスポンスから引き継いだ値を使用するかを設定できます。
        </p>
        <p>
            マクロ内の先行するレスポンスからリクエストのパラメータ値を引き継ぐ機能は、複数ステージのプロセスや、アプリケーションがCSRFトークンを積極的に使用している状況で特に有用です。パラメータの引き継ぎは、パラメータ名とリクエストされるURLに基づいて行われます。先行するレスポンスからのパラメータ値引き継ぎを指定した場合、関連するURLに送信された名前付きパラメータの元となったレスポンス(例えば、送信先に指定されているURLや、フォームのフィールド名の指定など)を調べます。見つかった場合、Burpはレスポンスからパラメータ値を抽出し、処理中のリクエストのパラメータを更新します。
        </p>
        <p>
            新しいマクロが定義されると、Burpは先行するレスポンス(フォームフィールドの値、リダイレクト先、リンクのクエリーストリングなど)から値を特定できるパラメータを特定することで、このような関連を自動的に見つけようとします。必要に応じて、自動分析を手動で上書きできます。
        </p>
        <h3 id="custom-parameter-locations-in-response">レスポンス内のカスタムパラメータ位置</h3>
        <p>
            Burpによるマクロ内アイテムのパラメータマッチングは、フォームフィールドの値やリンクのクエリーストリングのような、レスポンス内の既知の"通常"パラメータに対して自動的に動作します。場合によっては、これよりも柔軟に、レスポンス内の任意の場所をパラメータとして指定する機能が必要な場合があります。例えば、アプリケーションがCSRFトークンをJavaScript文字列として定義し、スクリプトがこれを追加して動的にリクエストを生成する場合です。このパラメータを引き継ぐマクロを作成するには、レスポンスのスクリプト内にあるパラメータの場所と、後続のリクエストのパラメータ名をBurpに設定する必要があります。
        </p>
        <p>
            "カスタムパラメータ定義"ダイアログを使用して、カスタムパラメータの名前と、設定されたレスポンスアイテムでそれを含む場所、及びレスポンスから抽出された値がURLエンコードされているかどうかを指定できます。これは<a href="../../functions/response-extraction.html">レスポンス抽出ルールダイアログ</a>を使用して設定します。これが完了すると<a href="#parameter-handling">パラメータハンドリング</a>で述べた通常の方法のように、後続のマクロリクエスト(または<a href="index.html#session-handling-rules">セッションハンドリングルール</a>で処理されるリクエスト)で、指定されたパラメータを使用できるようになります。
        </p>
        <p>
            レスポンスから抽出された値がURLエンコードされているかどうかの設定が重要です。これにより、後続のリクエストで値が使用されたときにBurp正しくエンコードできるようになり、配置されたコンテキストでURLエンコードが必要かどうかに反映されます。
        </p>
        <h2 id="re-analyze-macro">マクロを再解析</h2>
        <p>
            新しいマクロが定義されると、前のレスポンスから値を決定できるパラメータを特定し、マクロアイテム間の関係を自動的に見つけようとします。マクロ内のアイテムを手動で変更した場合は、"マクロを再解析"ボタンを使用して自動解析を再実行できます。
        </p>
        <h2 id="test-macro">マクロをテスト</h2>
        <p>
            先行するレスポンスからリクエストパラメータ引き継ぎをするマクロを設定したら、"マクロをテスト"機能を使用して、設定が想定通り動作しているか確認できます。これにより、マクロリクエストが順番に発行され、設定に応じてパラメータ値を引き継ごうとします。Burpは、その値が成功したか失敗したか確認するため、すべてのリクエストとレスポンス、受信したcookieの値、およびパラメータの詳細を表示します。
        </p>
    </div>
</section>
</body>
</html>