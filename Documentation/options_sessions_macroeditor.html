<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="css/ps.css">
</head>
<body>
<section class="container ps-breadcrumbs">
    <ol itemscope itemtype="http://schema.org/BreadcrumbList">
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="https://support.portswigger.net/">
            <span itemprop="name">サポートセンター</span>
            <meta itemprop="position" content="1"/>
            </a>
        </li>
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="index.html">
            <span itemprop="name">ドキュメント</span>
            <meta itemprop="position" content="2"/>
            </a>
        </li>
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="options.html">
            <span itemprop="name">オプション</span>
            <meta itemprop="position" content="3"/>
            </a>
        </li>
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="options_sessions.html">
            <span itemprop="name">セッション</span>
            <meta itemprop="position" content="4"/>
            </a>
        </li>
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="options_sessions_macroeditor.html">
            <span itemprop="name">マクロエディター</span>
            <meta itemprop="position" content="5"/>
            </a>
        </li>
    </ol>
</section>
<section class="maincontainer">
    <div class="container main">
        <h1>オプション: マクロエディター</h1>
        <p>
            マクロエディターでは、<a href="options_sessions.html#macros">マクロ</a>の詳細全てを設定できます。
        </p>
        <a name="record"></a>
        <h2>マクロの記録</h2>
        <p>
            マクロはブラウザを使用して記録されます。ブラウザは、現在のBurpインスタンスをプロキシーサーバーとして使用するよう<a href="suite_gettingstarted.html#browser">設定されている</a>必要があります。
        </p>
        <p>
            マクロを記録するとき、Burpが<a href="proxy_history.html">Proxy履歴</a>を表示するので、そこからマクロで使用するリクエストを選択できます。以前に作成したリクエストから選択するか、再度マクロを記録し、履歴から新たなアイテムを選択できます。ブラウザを使用して新しいマクロを記録するには、<a href="proxy_intercept.html">Proxyインターセプト</a>をオフにする必要があります。
        </p>
        <p>
            マクロに含めるアイテムを選択し、"OK"をクリックすると、マクロエディターにアイテムが表示されます。
        </p>
        <a name="configure"></a>
        <h2>マクロアイテムを設定</h2>
        <p>
            マクロエディターは、マクロ内のアイテムのリストを表示します。順番の変更、アイテムの削除、マクロの再記録によってこれらを変更できます。リストで選択すると個々のリクエストは変更でき、リクエストビューアで直接編集できます。
        </p>
        <p>
            リクエストの基本シーケンスと同様に、シーケンス内のアイテムの処理方法やアイテム間の依存関係に関する重要な設定が、各マクロにあります。マクロアイテムの設定を編集するには、リスト内でアイテムを選択し、"アイテム設定"をクリックします。
        </p>
        <a name="configure_cookies"></a>
        <h3>Cookieハンドリング</h3>
        <p>
            以下が設定できます:
        </p>
        <ul>
            <li>
                レスポンスで受け取ったcookieを、セッション管理cookie jarに追加するかどうか
            </li>
            <li>
                セッション管理cookie jarのcookieをリクエストに追加するかどうか
            </li>
        </ul>
        <a name="configure_params"></a>
        <h3>パラメーターハンドリング</h3>
        <p>
            リクエスト内の各パラメーターについて、固定の設定値を使用するか、マクロ内の先行するレスポンスから引き継いだ値を使用するかを設定できます。
        </p>
        <p>
            マクロ内の先行するレスポンスからリクエストのパラメーター値を引き継ぐ機能は、複数ステージのプロセスや、アプリケーションがCSRFトークンを積極的に使用している状況で特に有用です。パラメーターの引き継ぎは、パラメーター名とリクエストされるURLに基づいて行われます。先行するレスポンスからのパラメーター値引き継ぎを指定した場合、関連するURLに送信された名前付きパラメーターの元となったレスポンス(例えば、送信先に指定されているURLや、フォームのフィールド名の指定など)を調べます。見つかった場合、Burpはレスポンスからパラメーター値を抽出し、処理中のリクエストのパラメーターを更新します。
        </p>
        <p>
            新しいマクロが定義されると、Burpは先行するレスポンス(フォームフィールドの値、リダイレクト先、リンクのクエリーストリングなど)から値を特定できるパラメーターを特定することで、このような関連を自動的に見つけようとします。必要に応じて、自動分析を手動で上書きできます。
        </p>
        <a name="configure_custparams"></a>
        <h3>レスポンス内のカスタムパラメーターの場所</h3>
        <p>
            Burpによるマクロ内アイテムのパラメーターマッチングは、フォームフィールドの値やリンクのクエリーストリングのような、レスポンス内の既知の"通常"パラメーターに対して自動的に動作します。場合によっては、これよりも柔軟に、レスポンス内の任意の場所をパラメーターとして指定する機能が必要な場合があります。例えば、アプリケーションがCSRFトークンをJavaScript文字列として定義し、スクリプトがこれを追加して動的にリクエストを生成する場合です。このパラメーターを引き継ぐマクロを作成するには、レスポンスのスクリプト内にあるパラメーターの場所と、後続のリクエストのパラメーター名をBurpに設定する必要があります。
        </p>
        <p>
            "カスタムパラメーター定義"ダイアログを使用して、カスタムパラメーターの名前と、設定されたレスポンスアイテムでそれを含む場所、及びレスポンスから抽出された値がURLエンコードされているかどうかを指定できます。これは<a href="suite_functions_responseextraction.html">レスポンス抽出ルールダイアログ</a>を使用して設定します。これが完了すると<a href="#configure_params">パラメーターハンドリング</a>で述べた通常の方法のように、後続のマクロリクエスト(または<a href="options_sessions.html#sessionrules">セッションハンドリングルール</a>で処理されるリクエスト)で、指定されたパラメーターを使用できるようになります。
        </p>
        <p>
            レスポンスから抽出された値がURLエンコードされているかどうかの設定が重要です。これにより、後続のリクエストで値が使用されたときにBurp正しくエンコードできるようになり、配置されたコンテキストでURLエンコードが必要かどうかに反映されます。
        </p>
        <a name="reanalyze"></a>
        <h2>マクロの再分析</h2>
        <p>
            新しいマクロが定義されると、前のレスポンスから値を決定できるパラメーターを特定し、マクロアイテム間の関係を自動的に見つけようとします。マクロ内のアイテムを手動で変更した場合は、"マクロを再解析"ボタンを使用して自動解析を再実行できます。
        </p>
        <a name="test"></a>
        <h2>マクロのテスト</h2>
        <p>
            先行するレスポンスからリクエストパラメーター引き継ぎをするマクロを設定したら、"マクロをテスト"機能を使用して、設定が想定通り動作しているか確認できます。これにより、マクロリクエストが順番に発行され、設定に応じてパラメーター値を引き継ごうとします。Burpは、その値が成功したか失敗したか確認するため、すべてのリクエストとレスポンス、受信したcookieの値、およびパラメーターの詳細を表示します。
        </p>
    </div>
</section>
</body>
</html>